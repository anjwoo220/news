/Users/jaewoo/Documents/news project/utils.py:2: FutureWarning: 

All support for the `google.generativeai` package has ended. It will no longer be receiving 
updates or bug fixes. Please switch to the `google.genai` package as soon as possible.
See README for more details:

https://github.com/google-gemini/deprecated-generative-ai-python/blob/main/README.md

  import google.generativeai as genai
Starting batch job (Strict Mode + Images)...
Fetching RSS feeds (Balanced Mode)...
Fetching [General] https://www.bangkokpost.com/rss/data/topstories.xml...
Successfully parsed https://www.bangkokpost.com/rss/data/topstories.xml: Found 10 entries.
Fetching [General] https://www.thairath.co.th/rss/news...
Successfully parsed https://www.thairath.co.th/rss/news: Found 20 entries.
Skipping feed https://www.bangkokpost.com/rss/data/thailand.xml (Quota full for General)
Skipping feed https://www.bangkokpost.com/rss/data/most-recent.xml (Quota full for General)
Skipping feed https://www.khaosodenglish.com/feed/ (Quota full for General)
Skipping feed https://www.nationthailand.com/rss (Quota full for General)
Fetching [Business] https://www.prachachat.net/feed...
XML Parse Warning for https://www.prachachat.net/feed: <unknown>:9:1: duplicate attribute
Successfully parsed https://www.prachachat.net/feed: Found 30 entries.
Fetching Google News (Backup)...
Fetching Google News: Thailand Tourism...
 -> Found 0 items from Google News.
Total items fetched: 40
2026-01-13 17:27:33.455 WARNING streamlit.runtime.scriptrunner_utils.script_run_context: Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-01-13 17:27:33.514 
  [33m[1mWarning:[0m to view this Streamlit app on a browser, run it with the following
  command:

    streamlit run batch_job.py [ARGUMENTS]
2026-01-13 17:27:33.514 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-01-13 17:27:33.514 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-01-13 17:27:33.514 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-01-13 17:27:34.005 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-01-13 17:27:34.005 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-01-13 17:27:34.005 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-01-13 17:27:34.005 No runtime found, using MemoryCacheStorageManager
2026-01-13 17:27:34.006 No runtime found, using MemoryCacheStorageManager
2026-01-13 17:27:34.006 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-01-13 17:27:34.006 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-01-13 17:27:34.006 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-01-13 17:27:34.006 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-01-13 17:27:34.511 Thread 'Thread-2': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-01-13 17:27:34.512 Thread 'Thread-2': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-01-13 17:27:34.512 Thread 'Thread-2': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-01-13 17:27:35.989 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-01-13 17:27:35.989 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-01-13 17:27:35.989 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
Loaded 95 recent titles for similarity check.
Duplicate ID found, skipping: People's Party optimistic on forming govt
Items after duplicate/similarity check: 39
Items selected for API call: 8
 - Processing: Phuket starts tour boat cleanup after fire, fatal collision [General]
   - Scraping for image: https://www.bangkokpost.com/thailand/general/3174688/phuket-starts-tour-boat-cleanup-after-fire-fatal-collision
   + Found Image: https://static.bangkokpost.com/media/content/20260113/c1_3174688_700.jpg
 - Processing: ‡∏Å‡∏¢‡∏®. ‡πÄ‡∏£‡πà‡∏á‡∏ä‡πà‡∏ß‡∏¢‡∏ç‡∏≤‡∏ï‡∏¥‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏£‡πâ‡∏≠‡∏¢‡πÄ‡∏≠‡πá‡∏î ‡πÄ‡∏™‡∏µ‡∏¢‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï‡∏Ç‡∏ì‡∏∞‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏ß‡∏£ ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏£‡∏∞‡∏á‡∏±‡∏ö‡∏´‡∏ô‡∏µ‡πâ‡∏ä‡πà‡∏ß‡∏¢ [Business]
   + Found Image: https://www.prachachat.net/wp-content/uploads/2024/06/cover-2024-06-28T123209.373.jpg
 - Processing: Thai satellite falling back to earth after failed launch, but is insured [General]
   - Scraping for image: https://www.bangkokpost.com/thailand/general/3174620/thai-satellite-falling-back-to-earth-after-failed-launch-but-is-insured
   + Found Image: https://static.bangkokpost.com/media/content/20260113/c1_3174620_260113142143_700.jpg
 - Processing: ‡∏à‡∏≤‡∏Å‡πÄ‡∏à‡πâ‡∏≤‡∏û‡πà‡∏≠‡∏≠‡∏µ‡∏Ñ‡∏≠‡∏°‡πÄ‡∏°‡∏¥‡∏£‡πå‡∏ã ‡∏™‡∏π‡πà‡∏™‡∏ô‡∏≤‡∏°‡∏Å‡∏≤‡∏£‡πÄ‡∏°‡∏∑‡∏≠‡∏á ‚Äú‡∏õ‡πâ‡∏≠‡∏°-‡∏†‡∏≤‡∏ß‡∏∏‡∏ò‚Äù ‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏•‡∏∏‡∏¢‡πÅ‡∏Å‡πâ‡∏Å‡∏ï‡∏¥‡∏Å‡∏≤ ‡πÅ‡∏Ç‡πà‡∏á‡∏ó‡∏∏‡∏ô‡∏Ç‡πâ‡∏≤‡∏°‡∏ä‡∏≤‡∏ï‡∏¥ [Business]
   + Found Image: https://www.prachachat.net/wp-content/uploads/2026/01/pawoot2.png
 - Processing: ‚Äò‡πÄ‡∏ß‡∏µ‡∏¢‡∏î‡∏ô‡∏≤‡∏°‚Äô ‡πÄ‡∏Å‡∏¥‡∏ô‡∏î‡∏∏‡∏•‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏≤‡∏™‡∏´‡∏£‡∏±‡∏ê‡πÅ‡∏ã‡∏á‡∏à‡∏µ‡∏ô ‡∏£‡∏ö.‡∏ó‡∏£‡∏±‡∏°‡∏õ‡πå ‡πÄ‡∏•‡πá‡∏á‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ë‡∏π‡∏ï [Business]
   + Found Image: https://www.prachachat.net/wp-content/uploads/2026/01/vietnam-america-flag-moving-different-direction-3d-rendering-scaled.jpg
 - Processing: Pheu Thai courts gaming industry [General]
   - Scraping for image: https://www.bangkokpost.com/thailand/politics/3174243/pheu-thai-courts-gaming-industry
   + Found Image: https://static.bangkokpost.com/media/content/dcx/2026/01/13/5923918_700.jpg
 - Processing: UNIX ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Ç‡∏≤‡∏¢ IPO ‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 180 ‡∏•‡πâ‡∏≤‡∏ô‡∏´‡∏∏‡πâ‡∏ô ‡∏à‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏ó‡∏£‡∏î SET ‡∏õ‡∏µ‡∏ô‡∏µ‡πâ [Business]
   + Found Image: https://www.prachachat.net/wp-content/uploads/2026/01/UNIX.jpg
 - Processing: ‡∏ä‡∏µ‡πâ‡∏ä‡∏∞‡∏ï‡∏≤ "‡∏°‡∏≤‡∏£‡∏µ‡∏ô ‡πÄ‡∏•‡∏≠ ‡πÄ‡∏õ‡∏ô" ‡∏ú‡∏π‡πâ‡∏ô‡∏≥‡∏Ç‡∏ß‡∏≤‡∏à‡∏±‡∏î‡∏ù‡∏£‡∏±‡πà‡∏á‡πÄ‡∏®‡∏™ ‡∏≠‡∏∏‡∏ó‡∏ò‡∏£‡∏ì‡πå‡∏Ñ‡∏≥‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡∏Ñ‡∏î‡∏µ‡∏¢‡∏±‡∏Å‡∏¢‡∏≠‡∏Å‡πÄ‡∏á‡∏¥‡∏ô‡∏≠‡∏µ‡∏¢‡∏π [General]
   + Found Image: https://static.thairath.co.th/media/CiHZjUdJ5HPNXJ92O2xWGfp3aJqeHs3TTZ.jpg
Calling Gemini API...
Starting sequential analysis for 8 items...
[1/8] Processing: Phuket starts tour boat cleanup after fire, fatal collision...
   -> Scraped full content (1622 chars).
   -> Success. Topics so far: 1
   -> Waiting 20 seconds to respect API rate limits...
[2/8] Processing: ‡∏Å‡∏¢‡∏®. ‡πÄ‡∏£‡πà‡∏á‡∏ä‡πà‡∏ß‡∏¢‡∏ç‡∏≤‡∏ï‡∏¥‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏£‡πâ‡∏≠‡∏¢‡πÄ‡∏≠‡πá‡∏î ‡πÄ‡∏™‡∏µ‡∏¢‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï‡∏Ç‡∏ì‡∏∞‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏ß‡∏£ ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏£‡∏∞‡∏á‡∏±‡∏ö‡∏´‡∏ô‡∏µ‡πâ‡∏ä‡πà‡∏ß‡∏¢...
   -> Scraping failed/empty, falling back to summary.
   -> Success. Topics so far: 2
   -> Waiting 20 seconds to respect API rate limits...
[3/8] Processing: Thai satellite falling back to earth after failed launch, but is insured...
   -> Scraped full content (1718 chars).
   -> Success. Topics so far: 3
   -> Waiting 20 seconds to respect API rate limits...
[4/8] Processing: ‡∏à‡∏≤‡∏Å‡πÄ‡∏à‡πâ‡∏≤‡∏û‡πà‡∏≠‡∏≠‡∏µ‡∏Ñ‡∏≠‡∏°‡πÄ‡∏°‡∏¥‡∏£‡πå‡∏ã ‡∏™‡∏π‡πà‡∏™‡∏ô‡∏≤‡∏°‡∏Å‡∏≤‡∏£‡πÄ‡∏°‡∏∑‡∏≠‡∏á ‚Äú‡∏õ‡πâ‡∏≠‡∏°-‡∏†‡∏≤‡∏ß‡∏∏‡∏ò‚Äù ‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏•‡∏∏‡∏¢‡πÅ‡∏Å‡πâ‡∏Å‡∏ï‡∏¥‡∏Å‡∏≤ ‡πÅ‡∏Ç‡πà‡∏á‡∏ó‡∏∏‡∏ô‡∏Ç‡πâ‡∏≤‡∏°‡∏ä‡∏≤‡∏ï‡∏¥...
   -> Scraping failed/empty, falling back to summary.
   -> Success. Topics so far: 4
   -> Waiting 20 seconds to respect API rate limits...
[5/8] Processing: ‚Äò‡πÄ‡∏ß‡∏µ‡∏¢‡∏î‡∏ô‡∏≤‡∏°‚Äô ‡πÄ‡∏Å‡∏¥‡∏ô‡∏î‡∏∏‡∏•‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏≤‡∏™‡∏´‡∏£‡∏±‡∏ê‡πÅ‡∏ã‡∏á‡∏à‡∏µ‡∏ô ‡∏£‡∏ö.‡∏ó‡∏£‡∏±‡∏°‡∏õ‡πå ‡πÄ‡∏•‡πá‡∏á‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ë‡∏π‡∏ï...
   -> Scraping failed/empty, falling back to summary.
   -> Success. Topics so far: 5
   -> Waiting 20 seconds to respect API rate limits...
[6/8] Processing: Pheu Thai courts gaming industry...
   -> Scraped full content (3000 chars).
   -> Success. Topics so far: 6
   -> Waiting 20 seconds to respect API rate limits...
[7/8] Processing: UNIX ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Ç‡∏≤‡∏¢ IPO ‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 180 ‡∏•‡πâ‡∏≤‡∏ô‡∏´‡∏∏‡πâ‡∏ô ‡∏à‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏ó‡∏£‡∏î SET ‡∏õ‡∏µ‡∏ô‡∏µ‡πâ...
   -> Scraping failed/empty, falling back to summary.
   -> Success. Topics so far: 7
   -> Waiting 20 seconds to respect API rate limits...
[8/8] Processing: ‡∏ä‡∏µ‡πâ‡∏ä‡∏∞‡∏ï‡∏≤ "‡∏°‡∏≤‡∏£‡∏µ‡∏ô ‡πÄ‡∏•‡∏≠ ‡πÄ‡∏õ‡∏ô" ‡∏ú‡∏π‡πâ‡∏ô‡∏≥‡∏Ç‡∏ß‡∏≤‡∏à‡∏±‡∏î‡∏ù‡∏£‡∏±‡πà‡∏á‡πÄ‡∏®‡∏™ ‡∏≠‡∏∏‡∏ó‡∏ò‡∏£‡∏ì‡πå‡∏Ñ‡∏≥‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡∏Ñ‡∏î‡∏µ‡∏¢‡∏±‡∏Å‡∏¢‡∏≠‡∏Å‡πÄ‡∏á‡∏¥‡∏ô‡∏≠‡∏µ‡∏¢‡∏π...
   -> Scraped full content (2056 chars).
   -> Success. Topics so far: 8
Filtered topics from 8 to 1 based on scores.
2026-01-13 17:30:40.317 No runtime found, using MemoryCacheStorageManager
2026-01-13 17:30:40.318 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-01-13 17:30:40.318 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-01-13 17:30:40.318 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-01-13 17:30:40.318 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-01-13 17:30:40.821 Thread 'Thread-12': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-01-13 17:30:40.821 Thread 'Thread-12': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-01-13 17:30:40.821 Thread 'Thread-12': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-01-13 17:30:42.106 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-01-13 17:30:42.106 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-01-13 17:30:42.106 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-01-13 17:30:48.480 No runtime found, using MemoryCacheStorageManager
Saved 1 new topics to Google Sheets under key '2026-01-13'
Saved 1 new topics to data/news.json under key '2026-01-13'
Found 1 STRICT events. Cross-posting to data/events.json...
Marked 1 URLs as processed.
Updated data/processed_urls.json with 8 new URLs.
Fetching Twitter Trends...
Fetching Twitter Trends from trends24.in...
Top 10 Trends: ['#PetshoodXGulf11K', 'GULF\u200b FAM X PETSHOOD12K', '#SkyNani', '#‡∏™‡∏Å‡∏≤‡∏¢‡∏ô‡∏≤‡∏ô‡∏¥', '#DrPONGxPERTHSANTA85K', 'Social Media266K', '#KITKATxFOURTH', 'Lifestyle31K', 'THE FIRE Q7 SHOOTING17K', '3Yrs KHUNNOOS x GEMINIFOURTH39K']
Twitter Trend Error: Extra data: line 5 column 1 (char 8)
No critical twitter trends found or fetch failed.
